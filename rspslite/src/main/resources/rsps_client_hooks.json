[
  {
    "name": "RSNodeCache",
    "matching": {
      "isRootClass": true,
      "fields": ["int capacity", "int remainingCapacity"],
      "methods": [
        {
          "signature": "void I(long)",
          "bytecode": [
            ["aconst_null"]
          ]
        },
        {
          "signature": "void reset()",
          "bytecode": [
            ["aload_0", "getfield", "putfield", "return"]
          ]
        },
        {
          "signature": "java.lang.Object get(long)",
          "bytecode": [
            ["aload_0", "getfield", "lload_1", "invokevirtual", "checkcast"]
          ]
        }
      ]
    },
    "fieldFinders": [
      {
        "type": "method",
        "field": "remainingCapacity",
        "method": "I(long)",
        "bytecode": ["iconst_1", "iadd", "putfield"]
      },
      {
        "type": "logical_elimination",
        "field": "capacity"
      }
    ],
    "methodRenames": [
      {
        "signature": "java.lang.Object get(long)",
        "newName": "uninjectedGet"
      }
    ],
    "injections": {
      "interfaces": ["net.runelite.rs.api.RSNodeCache"],
      "newMethods": [
        "public void setCapacity(int n2) { $$field:capacity$$ = n2; }",
        "public void setRemainingCapacity(int n2) { $$field:remainingCapacity$$ = n2; }",
        "public net.runelite.rs.api.RSCacheableNode get(long l2) { return $$method:get(long)$$(l2); }",
        "public void reset() { $$method:reset()$$(); }"
      ]
    }
  },
  {
    "name": "RSNode",
    "matching": {
      "isRootClass": true,
      "fields": ["$$thisClass$$ next", "$$thisClass$$ prev", "long hash"],
      "methods": [
        {
          "signature": "void unlink()",
          "bytecode": [
            ["aload_0", "getfield", "aload_0", "getfield", "putfield"],
            ["aload_0", "aconst_null", "putfield", "return"]
          ]
        }
      ]
    },
    "fieldFinders": [
      {
        "type": "method",
        "field": "prev",
        "method": "unlink()",
        "bytecode": ["aconst_null", "aload_0", "getfield"]
      },
      {
        "type": "logical_elimination",
        "field": "next"
      },
      {
        "type": "logical_elimination",
        "field": "hash"
      }
    ],
    "injections": {
      "interfaces": ["net.runelite.rs.api.RSNode"],
      "newMethods": [
        "public long getHash() { return $$field:hash$$; }",
        "public net.runelite.rs.api.RSNode getNext() { return $$field:next$$; }",
        "public net.runelite.rs.api.RSNode getPrevious() { return $$field:prev$$; }",
        "public void unlink() { $$method:unlink()$$(); }",
        "public void onUnlink() { }"
      ]
    }
  },
  {
    "name": "RSCacheableNode",
    "matching": {
      "childOf": "RSNode",
      "fields": ["$$thisClass$$ next", "$$thisClass$$ prev", "long hash"],
      "methods": [
        {
          "signature": "void D()",
          "bytecode": [
            ["aload_0", "getfield", "ifnull"]
          ]
        }
      ]
    },
    "injections": {
      "interfaces": ["net.runelite.rs.api.RSCacheableNode"]
    }
  },
  {
    "name": "RSItemContainer",
    "matching": {
      "childOf": "RSNode",
      "fields": ["int[] itemIds", "int[] stackSizes"],
      "constructors": [
        {
          "name": "init",
          "paramTypes": [],
          "bytecode": [
            ["aload_0", "iconst_1",  "newarray", "dup", "iconst_0", "iconst_m1", "iastore", "putfield"]
          ]
        }
      ]
    },
    "fieldFinders": [
      {
        "type": "constructor",
        "field": "itemIds",
        "paramTypes": [],
        "bytecode": ["aload_0", "iconst_1",  "newarray", "dup", "iconst_0", "iconst_m1", "iastore", "putfield"]
      },
      {
        "type": "logical_elimination",
        "field": "stackSizes"
      }
    ],
    "injections": {
      "interfaces": ["net.runelite.rs.api.RSItemContainer"]
    }
  }
]
